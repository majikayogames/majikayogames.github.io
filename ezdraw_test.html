<!DOCTYPE html>
<html>

<head>
    <title>EZDraw</title>
    <style>
        /* canvas {
            border: 1px solid black;
        } */
    </style>
</head>

<body>
    <script src="ezdraw.js"></script>
    <script>
        ez.centerOrigin = true
        let drawCanvas = ez.createCanvasAndAddToPage()
        let mainCanvas = ez.createCanvasAndAddToPage()
        
        ez.onMouseDown(() => {
            ez.save()
            ez.centerOrigin = false
            ez.canvas = drawCanvas
            ez.camera = mat3x4()
            ez.rect(ez.getMousePos(), vec2(10, 10)).fill()
            ez.restore()
        })
        ez.onMouseDrag((deltaPos) => {
            ez.save()
            ez.centerOrigin = false
            ez.canvas = drawCanvas
            ez.camera = mat3x4()
            ez.bresenhamLineConnect(ez.lastMousePos, ez.mousePos).slice(1).forEach(pt => {
                let r = ez.rect(pt, vec2(10, 10))
                r.fill("#000000")
                console.log("Filled")
                console.log(r)
            })
            ez.restore()
        })

        function draw() {
            ez.clear()
            ez.grid(100,50).stroke(0xbbbbbb)
            let interp = (Date.now() % 10000) / 10000 * (Math.PI*2);
            ez.rect(ez.getMousePosWorld(),[100,100], interp).fillAndStroke("#aaddddaa")
            ez.useProjectionMatrix = 1.0;

            ez.rect(vec2(100,0).rotated(interp), [5,5]).fillAndStroke("red")

            ez.ctx.lineWidth = 1.5
            ez.line(vec2(0,-1000), vec2(0,1000)).stroke("grey")
            ez.line(vec2(-1000, 0), vec2(1000,0)).stroke("grey")
            ez.ctx.lineWidth = 3
            ez.arrow(vec2(0,0),vec2(0,-100),15).fillAndStroke("green", "green")
            ez.arrow(vec2(0,0),vec2(100,0),15).fillAndStroke("red", "red")
            ez.ctx.lineWidth = 1

            ez.camera = ez.camera.rotated(vec3(0,1,0), 0.002)
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>

</html>